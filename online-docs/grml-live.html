<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.2.2" />
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
}

strong {
  font-weight: bold;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1 {
  border-bottom: 2px solid silver;
}
h2 {
  border-bottom: 2px solid silver;
  padding-top: 0.5em;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revision {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble,
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-right: 10%;
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock {
  margin-right: 0%;
}
div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock > div.content {
  padding-left: 2.0em;
}

div.attribution {
  text-align: right;
}
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.verseblock div.content {
  white-space: pre;
}

div.imageblock div.content { padding-left: 0; }
div.imageblock img { border: 1px solid silver; }
span.image img { border-style: none; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: italic;
}
dd > *:first-child {
  margin-top: 0;
}

ul, ol {
    list-style-position: outside;
}
ol.olist2 {
  list-style-type: lower-alpha;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}

div.hlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hlist td {
  padding-bottom: 5px;
}
td.hlist1 {
  vertical-align: top;
  font-style: italic;
  padding-right: 0.8em;
}
td.hlist2 {
  vertical-align: top;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-content {
  padding-left: 2.0em;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
<title>grml-live(8)</title>
</head>
<body>
<div id="header">
<h1>grml-live(8)</h1>
</div>
<h2>Name</h2>
<div class="sectionbody">
<p>grml-live - build framework based on FAI for generating a grml and Debian based
Linux Live system (CD/ISO)</p>
</div>
<h2>Synopsis</h2>
<div class="sectionbody">
<p>grml-live [-a &lt;architecture&gt;] [-c &lt;classe[s]&gt;] [-C &lt;configfile&gt;] [-g
&lt;grml_name&gt;] [-i &lt;iso_name&gt; ] [-o &lt;output_directory&gt;] [-r &lt;release_name&gt;] [-s
&lt;suite&gt;] [-t &lt;template_directory&gt;] [-v &lt;version_number&gt;] [-bFhuVz]</p>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution" />
</td>
<td class="content">Please check out <a href="#current_state">the <em>Current state of grml-live with squashfs-tools and kernel</em> section</a> for details about current state of involved
tools before starting with grml-live or if you encounter any problems.</td>
</tr></table>
</div>
</div>
<h2>Description</h2>
<div class="sectionbody">
<p>grml-live provides the build system for creating a grml and Debian based Linux
Live-CD. The build system is based on
<a href="http://www.informatik.uni-koeln.de/fai/">FAI</a> (Fully Automatic
Installation). grml-live uses the "fai dirinstall" feature to generate a chroot
system based on the class concept of FAI (see later sections for further
details) and provides the framework to be able to generate a full-featured ISO.
It does not use all the FAI features by default though and you don't have to
know FAI to be able to use it.</p>
<p>The use of FAI gives you the flexibility to choose the packages you would like
to include on your very own Linux Live-CD without having to deal with all the
details of a build process.</p>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution" />
</td>
<td class="content">grml-live does <strong>not</strong> use /etc/fai for configuration but instead
provides and uses /etc/grml/fai. This ensures that it does not clash with
default FAI configuration and packages, so you can use grml-live and FAI
completely independent at the same time!</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Please notice that you should have a fast network connection as all the Debian
packages will be downloaded and installed via network. If you want to use a
local mirror (strongly recommended if you plan to use grml-live more than once)
checkout mkdebmirror (see /usr/share/doc/grml-live/examples/mkdebmirror),
debmirror(1), reprepro(1) (see /usr/share/doc/grml-live/examples/reprepro/ for a
sample configuration), apt-cacher(1) and approx(8). To avoid downloading the
base system again and again check out FAI's NFSROOT (see FAQ of this document
for details).</td>
</tr></table>
</div>
</div>
<h2>Options</h2>
<div class="sectionbody">
<dl>
<dt>
-a <strong>ARCHITECTURE</strong>
</dt>
<dd>
<p>
Use the specified architecture instead of the currently running one.  This
allows building a 32bit system on a 64bit host (though you can't build a 64bit
system on a 32bit system/kernel of course). Please notice that real
crosscompiling (like building a ppc system on x86) isn't possible due to the
nature and the need of working in a chroot. Currently supported values: i386
and amd64.
</p>
</dd>
<dt>
-b
</dt>
<dd>
<p>
Build the ISO without updating the chroot via FAI. This option is useful for
example when working on stable releases: if you have a working base
system/chroot and do not want to execute any further updates (via "-u" option)
but intend to only build the ISO.
</p>
</dd>
<dt>
-c <strong>CLASSES</strong>
</dt>
<dd>
<p>
Specify the CLASSES to be used for building the ISO via FAI.  By default only
the classes GRMLBASE, GRML_SMALL and I386 are assumed, resulting in a small base
system (being about ~150MB total ISO size). If using a non-I386 system (like
amd64) you should specify the appropriate architecture as well. Additionally you
can specify a class providing a grml-kernel (see
<a href="#classes">the <em>CLASSES</em> section in this document</a> for details about available classes).
So instead of GRML_SMALL you can also use GRML_MEDIUM and GRML_FULL.
</p>
</dd>
<dt>
-C <strong>CONFIGURATION_FILE</strong>
</dt>
<dd>
<p>
The specified file is used as configuration file for grml-live. By default
/etc/grml/grml-live.conf is used for main configuration. If a file named
/etc/grml/grml-live.local exists it is used as well (sourced after reading
/etc/grml/grml-live.conf to allow overriding settings). As a last option the
specified configuration file is sourced so it is possible to override settings
of /etc/grml/grml-live.conf as well as of /etc/grml/grml-live.local. Please
notice that all configuration files have to be adjusted during execution of
grml-live, so please make sure you use /etc/grml/grml-live.conf as a base for
your own configuration file. Please also notice that the configuration file
specified via this option is <strong>not</strong> (yet) supported inside the
scripts/hooks/classes at /etc/grml/fai/config. Instead use
/etc/grml/grml-live.conf and/or /etc/grml/grml-live.local for configuration
stuff used inside /etc/grml/fai/config.
</p>
</dd>
<dt>
-F
</dt>
<dd>
<p>
Force execution and do not prompt for acknowledgment of configuration.
</p>
</dd>
<dt>
-g <strong>GRML_NAME</strong>
</dt>
<dd>
<p>
Set the grml flavour name. Common usage examples: grml, grml-small, grml64.
Please do NOT use blanks and any special characters like <em>/</em>, <em>;</em> inside
GRML_NAME, otherwise you might notice problems with booting.
</p>
</dd>
<dt>
-h
</dt>
<dd>
<p>
Display short usage information and exit.
</p>
</dd>
<dt>
-i <strong>ISO_NAME</strong>
</dt>
<dd>
<p>
Specify name of ISO which will be available inside $OUTPUT_DIRECTORY/grml_isos
by default.
</p>
</dd>
<dt>
-o <strong>OUTPUT_DIRECTORY</strong>
</dt>
<dd>
<p>
Main output directory of the build process of FAI.  Some directories are created
inside this target directory, being: grml_cd (where the files for creating the
ISO are located, including the compressed squashfs file), grml_chroot (the
chroot system) and grml_isos (where the resulting ISO is stored).
</p>
</dd>
<dt>
-r <strong>RELEASENAME</strong>
</dt>
<dd>
<p>
Specify name of the release.
</p>
</dd>
<dt>
-s <strong>SUITE</strong>
</dt>
<dd>
<p>
Specify the Debian suite you want to use for your live-system.  Defaults to
"etch" (being current Debian/stable). Supported values are: etch, lenny, sid.
</p>
</dd>
<dt>
-t <strong>TEMPLATE_DIRECTORY</strong>
</dt>
<dd>
<p>
Specify place of the templates used for building the ISO. By default
(and if not manually specified) this is /usr/share/grml-live/templates/.
</p>
</dd>
<dt>
-u
</dt>
<dd>
<p>
Update existing chroot instead of rebuilding it from scratch. This option is
based on the softupdate feature of FAI.
</p>
</dd>
<dt>
-v <strong>VERSION_NUMBER</strong>
</dt>
<dd>
<p>
Specify version number of the release.
</p>
</dd>
<dt>
-V
</dt>
<dd>
<p>
Increase verbosity in the build process.
</p>
</dd>
<dt>
-z
</dt>
<dd>
<p>
Use ZLIB instead of LZMA compression in mksquashfs part of the build process.
</p>
</dd>
</dl>
</div>
<h2>Usage examples</h2>
<div class="sectionbody">
<p>To get a small, Debian-stable and grml-based Live-CD using /grml/grml-live
as build and output directory just run:</p>
<div class="literalblock">
<div class="content">
<pre><tt># grml-live</tt></pre>
</div></div>
<p>To get a small Debian-unstable and grml-small based Live-CD using
/home/mika/grml-live as build and output directory just use:</p>
<div class="literalblock">
<div class="content">
<pre><tt># grml-live -s sid -c GRMLBASE,GRML_SMALL,I386 -o /home/mika/grml-live</tt></pre>
</div></div>
<p>To get a medium sized, Debian-unstable and grml-based Live-CD for i386
architecture using /grml/grml-live as build and output directory just run:</p>
<div class="literalblock">
<div class="content">
<pre><tt># grml-live -s sid -a i386 -c GRMLBASE,GRML_MEDIUM,I386</tt></pre>
</div></div>
<p>To get a small, Debian-unstable and grml-based Live-CD using /tmp as build and
output directory and use grml_0.0-3.iso as ISO name (placed inside
/tmp/grml_isos) just invoke:</p>
<div class="literalblock">
<div class="content">
<pre><tt># grml-live -o /tmp -c GRMLBASE,GRML_SMALL,I386 -s sid -i grml_0.0-3.iso</tt></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">If you have about 700MB of free space inside /dev/shm (being a tmpfs, usually
you should have &gt;=1GB of RAM) just run "mount -o remount,suid,dev,rw /dev/shm"
and use /dev/shm as build and output directory - resulting in very fast build
process.  But please be aware of the fact that rebooting your system will result
in an empty /dev/shm, so please use another directory for $CHROOT_OUTPUT,
$BUILD_OUTPUT and $ISO_OUTPUT if you plan to create more persistent output. :)</td>
</tr></table>
</div>
</div>
<h2>Main features of grml-live</h2>
<div class="sectionbody">
<ul>
<li>
<p>
create a grml-/Debian-based Linux Live-CD with one single command
</p>
</li>
<li>
<p>
class based concept, providing a maximum of flexibility
</p>
</li>
<li>
<p>
supports integration of own hooks, scripts and configuration
</p>
</li>
<li>
<p>
supports use and integration of own Software and/or Kernels via simple use of
Debian repositories
</p>
</li>
<li>
<p>
native support of FAI features
</p>
</li>
<li>
<p>
multi-arch support (work in progress)
</p>
</li>
</ul>
</div>
<h2>The class concept</h2>
<div class="sectionbody">
<p>grml-live uses FAI and its class based concept for adjusting configuration and
setup according to your needs. This gives you flexibility and strength without
losing the simplicity in the build process.</p>
<p>The main and base class provided by grml-live is named GRMLBASE. It's strongly
recommended to <strong>always</strong> use the class GRMLBASE when building an ISO using
grml-live, as well as the architecture dependent class which provides the kernel
(being <em>I386</em> for x86_32 and <em>AMD64</em> for x86_64) and a GRML_* class (like
GRML_SMALL, GRML_MEDIUM or GRML_FULL). The following files and directories are
relevant for class GRMLBASE by default:</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/config/scripts/GRMLBASE/
/etc/grml/fai/config/debconf/GRMLBASE
/etc/grml/fai/config/class/GRMLBASE.var
/etc/grml/fai/config/hooks/instsoft.GRMLBASE
/etc/grml/fai/config/package_config/GRMLBASE</tt></pre>
</div></div>
<p>Take a look at the next section for information about the concept of those
files/directories.</p>
<p>If you want to use your own configuration, extend an existing configuration
and/or add additional packages to your ISO just invent a new class (or extend an
existing one). For example if you want to use your own class named "FOOBAR" just
extend CLASSES="GRMLBASE,GRML_SMALL,I386" inside /etc/grml/grml-live.conf to
CLASSES="GRMLBASE,GRML_SMALL,I386,FOOBAR" or invoke grml-live using the classes
option: "grml-live -c GRMLBASE,GRML_SMALL,I386,FOOBAR &#8230;".</p>
<p>More details regarding the class concept can be found in the documentation of
FAI itself (being available at /usr/share/doc/fai-doc/).</p>
</div>
<h2><a id="classes"></a>Available classes</h2>
<div class="sectionbody">
<p>The package selection part of the classes can be found in
/etc/grml/fai/config/package_config whereas some further classes are defined for
example in /etc/grml/fai/config/scripts/ so specific feature sets can be
selected. The following classes are predefined:</p>
<ul>
<li>
<p>
DEBORPHAN: get rid of all packages listed in output of Deborphan
</p>
</li>
<li>
<p>
GRMLBASE: the main class responsible for getting a minimal subset of what's
defining a grml system. Important parts of the buildprocess are specified in
this class as well, so unless you have a really good reason you should always
use this class.
</p>
</li>
<li>
<p>
GRML_FORENSIC: tools for forensic investigations which has been created
by people from <a href="http://www.forensic-geeks.org/">forensic-geeks.org</a>.
</p>
</li>
<li>
<p>
GRML_FULL: full featured grml, also known as the "normal", full grml.
</p>
</li>
<li>
<p>
GRML_MEDIUM: medium sized grml version, known as grml-medium
</p>
</li>
<li>
<p>
GRML_POWERPC: grml for PowerPC architecture, not supported yet (still work in
progress)
</p>
</li>
<li>
<p>
GRML_SMALL: minimum sized grml version, known as grml-small
</p>
</li>
<li>
<p>
LATEX_CLEANUP: get rid of several very large LaTeX directories
(like some /usr/share/doc/texlive-*, /usr/share/doc/texmf,&#8230;)
</p>
</li>
<li>
<p>
LOCALES: use full featured locales setup (see /etc/locale.gen.grml)
</p>
</li>
<li>
<p>
NO_ONLINE: do not run scripts during the chroot build process which require a
network connection
</p>
</li>
<li>
<p>
RELEASE: run some specific scripts and commands to provide the workflow for an
official grml release
</p>
</li>
<li>
<p>
REMOVE_DOCS: get rid of documentation directories (like /usr/share/doc,
/usr/share/man/, /usr/share/info,&#8230;)
</p>
</li>
<li>
<p>
XORG: providing important packages for use with a base grml-featured X.org
setup
</p>
</li>
</ul>
</div>
<h2>Files</h2>
<div class="sectionbody">
<p>Notice that grml-live ships FAI configuration files that do not use the same
namespace as the FAI packages itself. This ensures that grml-live does not clash
with your usual FAI configuration, so instead of /etc/fai/fai.conf (package
fai-client) grml uses /etc/grml/fai/fai.conf instead. For more details see
below. To get an idea how another configuration or example files could look like
check out /usr/share/doc/fai-doc/examples/simple/ (provided by Debian package
fai-doc). Furthermore /usr/share/doc/fai-doc/fai-guide.html/ch-config.html
provides documentation regarding configuration possibilities.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/usr/sbin/grml-live</tt></pre>
</div></div>
<p>Script for the main build process. Requires root permissions for execution.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/grml-live.conf</tt></pre>
</div></div>
<p>Main configuration file for grml-live. All the important steps can be configured
at this stage.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/fai.conf</tt></pre>
</div></div>
<p>Main configuration file for FAI which specifies where all the configuration
files and scripts for FAI/grml-live can be found. By default it is set to
FAI_CONFIGDIR=/etc/grml/fai/config, a directory shipped by grml-live
out-of-the-box so you shouldn't have to configure anything in this file.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/make-fai-nfsroot.conf</tt></pre>
</div></div>
<p>This file is used by make-fai-nfsroot(8) only. Usually you don't have to change
anything inside this file. If you want to modify NFSROOT though you can adjust
it there.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/NFSROOT</tt></pre>
</div></div>
<p>This file specifies the package list for creating the NFSROOT.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/apt/sources.list</tt></pre>
</div></div>
<p>This file specifies which mirrors should be used for retreiving the Debian
packages used for creating the main chroot (including all the software you would
like to see included). If you want to use a local mirror you either have to
adjust this file or use the GRML_LIVE_SOURCES variable inside
/etc/grml/grml-live.conf which modifies /etc/grml/fai/apt/sources.list
on-the-fly then.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/config/</tt></pre>
</div></div>
<p>The main directory for configuration of FAI/grml-live. More details below.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/config/class/</tt></pre>
</div></div>
<p>This directory contains files which specify main configuration variables for the
FAI classes.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/config/debconf/</tt></pre>
</div></div>
<p>This directory provides the files for preseeding/configuration of debconf
through files.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/config/hooks/</tt></pre>
</div></div>
<p>This directory provides files for customising the build process through hooks.
Hooks are user defined programs or scripts, which are called during the
installation process.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/config/package_config/</tt></pre>
</div></div>
<p>Directory with lists of software packages to be installed or removed.  The
different classes describe what should find its way to your ISO.  When running
"grml-live -c GRMLBASE,GRML_SMALL,I386 &#8230;" only the configuration of GRMLBASE,
GRML_SMALL and and I386 will be taken. If you use <em>grml-live -c
GRMLBASE,GRML_SMALL,I386,FOOBAR &#8230;</em> then the files of GRMLBASE, GRML_SMALL,
I386 <strong>plus</strong> the files from FOOBAR will be taken. So just create a new class to
adjust the package selection according to your needs.  Please notice that the
directory GRMLBASE contains a package list defining a minimum but still
reasonable package configuration.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/config/scripts/</tt></pre>
</div></div>
<p>Scripts for customising the ISO within the build process.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/files/</tt></pre>
</div></div>
<p>This directory provides files used inside the scripts of
/etc/grml/fai/config/scripts/*. For a full documentation what happens with the
files please refer to the source of the scripts.</p>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/grml/fai/live-initramfs/</tt></pre>
</div></div>
<p>This directory provides the files used for building the initramfs/initrd via
live-initramfs(8).</p>
</div>
<h2>Available log files</h2>
<div class="sectionbody">
<p>grml-live itself logs to /var/log/grml-live.log. Unless you set ZERO_LOGFILE in
/etc/grml/grml-live.conf the output is appended to the file. If you set the
ZERO_LOGFILE configuration option the logfile will be truncated on each new
invocation of grml-live.</p>
<p>The FAI part of grml-live logs to /var/log/fai/$HOSTNAME/ - so the
default being /var/log/fai/grml/.</p>
<p>If you are using the grml-live buildd you will find the logs of the grml-live
run at /var/log/grml-buildd.stdout and /var/log/grml-buildd.stderr.</p>
</div>
<h2>Requirements for the build system</h2>
<div class="sectionbody">
<ul>
<li>
<p>
any Debian based system should be sufficient (if not it's a bug, so please
send us a bug report then) [a usual <a href="http://grml.org/grml2hd/">grml2hd</a>
harddisk installation ships all you need]
</p>
</li>
<li>
<p>
enough free disk space; at least 800MB are required for a minimal grml-live
run (~400MB for the chroot [$CHROOT_OUTPUT], ~150MB for the build target
[$BUILD_OUTPUT] and ~150MB for the resulting ISO [$ISO_OUTPUT] plus some
temporary files), if you plan to use GRML_FULL you should have at least 4GB of
total free disk space
</p>
</li>
<li>
<p>
fast network access for retreiving the Debian packages used for creating the
chroot (check out "local mirror" and "NFSROOT" to workaround this problem as far
as possiblbe)
</p>
</li>
</ul>
<p>For further information see next section.</p>
</div>
<h2><a id="current_state"></a>Current state of grml-live with squashfs-tools and kernel</h2>
<div class="sectionbody">
<p>To make it easier to track problems this section documents current state of
grml-live playing together with squashfs-tools / squashfs-lzma-tools (for
building the compressed file) and the kernel version. Documentation of this
section is up2date by 27th of september 2008.</p>
<h3>System</h3>
<ul>
<li>
<p>
grml-live, version 0.9.4
</p>
</li>
<li>
<p>
building grml-medium (Debian/unstable)
</p>
</li>
<li>
<p>
software versions used in the ISO (being installed automatically, recorded
just as a reference):
</p>
<div class="literalblock">
<div class="content">
<pre><tt>ii  busybox             1:1.10.2-2          Tiny utilities for small and embedded systems
ii  initramfs-tools     0.92f.grml01        tools for generating an initramfs
ii  klibc-utils         1.5.12-2            small utilities built with klibc for early boot
ii  live-initramfs      1.139.1-2grml.01    Debian Live initramfs hook
ii  lvm2                2.02.39-2           The Linux Logical Volume Manager
ii  mdadm               2.6.7-3.1           tool to administer Linux MD arrays (software RAID)
ii  udev                0.125-6grml0        /dev/ and hotplug management daemon</tt></pre>
</div></div>
</li>
</ul>
<h3>Using squashfs-lzma-tools 3.3-1 on the build system</h3>
<p>squashfs-lzma-tools from the grml repository supports kernel 2.6.26-grml
(version &gt;=grml.05) using both lzma and zlib (-nolzma) compression. It's the
recommended package for building ISOs with grml-live currently.</p>
<h3>Using squashfs-tools 1:3.3-7 on the build system</h3>
<p>squashfs-tools 1:3.3-7 is available via Debian/unstable and Debian/testing
(lenny) pool running:</p>
<div class="literalblock">
<div class="content">
<pre><tt># aptitude install squashfs-tools=1:3.3-7</tt></pre>
</div></div>
<p>or directly via downloading the files
http://grml.org/squashfs/squashfs-tools_3.3-7_i386.deb (for x86) or
http://grml.org/squashfs/squashfs-tools_3.3-7_amd64.deb (for amd64) [both build
on and for Debian/etch but working with testing and unstable as well].</p>
<p>Please notice that squashfs-tools 1:3.3-7 does NOT support LZMA compression at
all. The -nolzma option of mksquashfs is not available therefore (even
though grml-live will deactivate it for you automatically anyway). Please
use squashfs-lzma-tools instead.</p>
<ul>
<li>
<p>
Kernel 2.6.23-grml: does NOT work, please use squashfs-tools 1:3.2r2-9exp1
                    instead if you still want to use kernel 2.6.23
</p>
</li>
<li>
<p>
Kernel 2.6.26-grml: works
</p>
</li>
</ul>
<h3>Using squashfs-tools 1:3.2r2-9exp1 on the build system</h3>
<p>squashfs-tools 1:3.2r2-9exp1 is available via the grml-testing repository,
running:</p>
<div class="literalblock">
<div class="content">
<pre><tt># aptitude install squashfs-tools=1:3.2r2-9exp1</tt></pre>
</div></div>
<p>or directly via downloading the files
http://grml.org/squashfs/squashfs-tools_3.2r2-9exp1_i386.deb (for x86) or
http://grml.org/squashfs/squashfs-tools_3.2r2-9exp1_amd64.deb (for amd64).</p>
<p>Versions with ZLIB compression (SQUASHFS_OPTIONS=<em>-nolzma</em> or -z
option in grml-live cmdline):</p>
<ul>
<li>
<p>
Kernel 2.6.23-grml: works
</p>
</li>
<li>
<p>
Kernel 2.6.26-grml: works
</p>
</li>
</ul>
<p>Versions with LZMA compression:</p>
<ul>
<li>
<p>
Kernel 2.6.23-grml: works
</p>
</li>
<li>
<p>
Kernel 2.6.26-grml: does NOT work, please use zlib mode instead
</p>
</li>
</ul>
</div>
<h2>FAQ</h2>
<div class="sectionbody">
<h3>Help, I'm using Debian etch and I don't have FAI version &gt;3.2</h3>
<div class="literalblock">
<div class="content">
<pre><tt>wget http://www.informatik.uni-koeln.de/fai/download/etch/fai-client_3.2.8_all.deb \
     http://www.informatik.uni-koeln.de/fai/download/etch/fai-server_3.2.8_all.deb \
     http://www.informatik.uni-koeln.de/fai/download/etch/fai-doc_3.2.8_all.deb
dpkg -i fai-client_3.2.8_all.deb fai-server_3.2.8_all.deb fai-doc_3.2.8_all.deb</tt></pre>
</div></div>
<p>or check out the <a href="http://www.informatik.uni-koeln.de/fai/">FAI-homepage</a> for
further details.</p>
<h3>I've problems with the build process. How to start debugging?</h3>
<p>Check out the logs inside /var/log/fai/&#8230; If you don't have the time to debug
the problem in further detail or don't know how to proceed just send a copy of
your config, logs and the commandline with a short problem description to
&lt;mika@grml.org&gt;:</p>
<div class="literalblock">
<div class="content">
<pre><tt># history | grep grml-live &gt; /etc/grml/grml_live.cmdline
# tar zcf grml_live_problem.tar.gz /etc/grml/grml-live.conf \
          /etc/grml/grml-buildd.conf /var/log/fai /etc/grml/fai</tt></pre>
</div></div>
<h3>Can I use my own (local) Debian mirror?</h3>
<p>Sure. Just adjust the variables GRML_LIVE_SOURCES and FAI_DEBOOTSTRAP (if not
already using NFSROOT's base.tgz) inside /etc/grml/grml-live.conf according to
your needs. Please don't forget that you should use the grml servers as well
(see default configuration) so all the grml packages can be downloaded as well.</p>
<p>If you want to use a local (for example NFS mount) mirror additionally, just
adjust MIRROR_DIRECTORY and MIRROR_SOURCES inside /etc/grml/grml-live.conf as
well.</p>
<p>Unless you specify GRML_LIVE_SOURCES and/or FAI_DEBOOTSTRAP the default from
/etc/grml/fai/apt/sources.list and /etc/grml/fai/make-fai-nfsroot.conf will be
taken. If you customise the variables in /etc/grml/grml-live.conf then the two
files will be adjusted during runtime automatically.</p>
<p>If MIRROR_DIRECTORY and MIRROR_SOURCES are specified the local mirror will be
taken as first entry in the generated sources.list so it's prefered over
non-local mirrors. Using a fallback mirror (via providing several mirrors in
GRML_LIVE_SOURCES as used by default) is a recommended setting.</p>
<h3>How do I add additional Debian package(s) to my CD/ISO?</h3>
<p>Just create a new class (using the package_config directory):</p>
<div class="literalblock">
<div class="content">
<pre><tt># cat &gt; /etc/grml/fai/config/package_config/MIKA &lt;&lt; EOF
PACKAGES aptitude</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>vim
another_name_of_a_debian_package
and_another_one
EOF</tt></pre>
</div></div>
<p>and specify it when invoking grml-live then:</p>
<div class="literalblock">
<div class="content">
<pre><tt># grml-live -c GRMLBASE,GRML_SMALL,I386,MIKA</tt></pre>
</div></div>
<h3>I fscked up my grml-live configuration. How do I reset it to the defaults?</h3>
<p>Notice: this deletes all your grml-live configuration files. If that's really
what you are searching for just run:</p>
<div class="literalblock">
<div class="content">
<pre><tt>rm -rf /etc/grml/fai /etc/grml/grml-live.conf
dpkg -i --force-confnew --force-confmiss /path/to/grml-live_..._all.deb</tt></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">If you don't control your /etc using a version control system (VCS) yet it's a
good chance to start using it now. Check out
<a href="http://michael-prokop.at/blog/2007/03/14/maintain-etc-with-mercurial-on-debian/">http://michael-prokop.at/blog/2007/03/14/maintain-etc-with-mercurial-on-debian/</a>
for more details how to maintain /etc using the mercurial VCS.</td>
</tr></table>
</div>
<h3>How do I create a base.tgz for use as NFSROOT?</h3>
<p>First of all build the chroot system:</p>
<div class="literalblock">
<div class="content">
<pre><tt>mkdir /tmp/nfsroot &amp;&amp; cd /tmp/nfsroot
debootstrap etch /tmp/nfsroot/ http://ftp.de.debian.org/debian
tar zcf base.tgz ./</tt></pre>
</div></div>
<p>Then check out where your NFSROOT is located:</p>
<div class="literalblock">
<div class="content">
<pre><tt># grep '^NFSROOT' /etc/grml/fai/make-fai-nfsroot.conf
NFSROOT=/grml/fai/nfsroot</tt></pre>
</div></div>
<p>So as /grml/fai/nfsroot is your NFSROOT place the file under
/grml/fai/nfsroot/live/filesystem.dir/var/tmp/:</p>
<div class="literalblock">
<div class="content">
<pre><tt>mv base.tgz /grml/fai/nfsroot/live/filesystem.dir/var/tmp/base.tgz</tt></pre>
</div></div>
<p>or even better use /etc/grml/fai/config/basefiles/$CLASSNAME.tar.gz instead.
Use I386 as $CLASSNAME for i386 builds and AMD64 for amd64 builds.</p>
<p>Now running "grml-live &#8230;" will use this file as main system instead of
executing debootstrap. Check out the output for the following lines if using
NFSROOT:</p>
<div class="literalblock">
<div class="content">
<pre><tt>[...]
Calling task_extrbase
Unpacking Debian base archive
Extracting /grml/fai/nfsroot/live/filesystem.dir/var/tmp/base.tgz
Calling task_mirror
[...]</tt></pre>
</div></div>
<p>or if using /etc/grml/fai/config/basefiles/$CLASSNAME.tar.gz for:</p>
<div class="literalblock">
<div class="content">
<pre><tt>[...]
ftar: extracting /etc/grml/fai/config/basefiles///AMD64.tar.gz to
/grml-live/grml-live_20071029.22138/grml_chroot//
[...]</tt></pre>
</div></div>
<h3>Set up apt-cacher for use with grml-live</h3>
<p>Make sure /etc/grml/grml-live.conf provides according GRML_LIVE_SOURCES and
FAI_DEBOOTSTRAP:</p>
<div class="literalblock">
<div class="content">
<pre><tt># cat /etc/grml/grml-live.conf
[...]
GRML_LIVE_SOURCES="
deb http://localhost:3142/deb.grml.org grml-stable  main
deb http://localhost:3142/deb.grml.org grml-testing main
deb http://localhost:3142/ftp.de.debian.org/debian etch main contrib non-free
"
[...]
FAI_DEBOOTSTRAP="etch http://localhost:3142/ftp.de.debian.org/debian etch main contrib non-free"</tt></pre>
</div></div>
<p>Make sure apt-cacher is running (/etc/init.d/apt-cacher restart). That's it.
All downloaded files will be cached in /var/cache/apt-cacher/ now.</p>
<h3>Set up approx for use with grml-live</h3>
<p>Make sure /etc/grml/grml-live.conf provides according GRML_LIVE_SOURCES and
FAI_DEBOOTSTRAP:</p>
<div class="literalblock">
<div class="content">
<pre><tt># cat /etc/grml/grml-live.conf
[...]
GRML_LIVE_SOURCES="
deb http://localhost:9999/grml            grml-stable  main
deb http://localhost:9999/grml            grml-testing main
deb http://localhost:9999/debian etch     main contrib non-free
"
FAI_DEBOOTSTRAP="etch http://localhost:9999/debian"</tt></pre>
</div></div>
<p>Configure approx:</p>
<div class="literalblock">
<div class="content">
<pre><tt># cat /etc/approx/approx.conf
[...]
debian http://ftp.at.debian.org/debian
grml   http://deb.grml.org/</tt></pre>
</div></div>
<p>Don't forget to restart approx (/etc/init.d/approx restart). That's it.
All downloaded files will be cached in /var/cache/approx now.</p>
<h3>I've a question which isn't answered by this document</h3>
<p>Don't hesitate to ask on IRC (channel #grml on irc.oftc.net) or just drop me
a mail: &lt;mika@grml.org&gt;</p>
</div>
<h2>Download / install grml-live as a Debian package</h2>
<div class="sectionbody">
<p>Debian packages are available through the grml-repository at
<a href="http://deb.grml.org/pool/main/g/grml-live/">deb.grml.org</a>.  If you want to
build a Debian package on your own (using for example a specific version or the
current development tree), just execute:</p>
<div class="literalblock">
<div class="content">
<pre><tt>hg clone http://hg.grml.org/grml-live
cd grml-live
debuild -us -uc</tt></pre>
</div></div>
</div>
<h2>Source</h2>
<div class="sectionbody">
<p>The source of grml-live is available at
<a href="http://hg.grml.org/grml-live/">http://hg.grml.org/grml-live/</a></p>
</div>
<h2>TODO list</h2>
<div class="sectionbody">
<p>Check out <a href="https://github.com/grml/grml/wiki/grml-live">grml-live@grml-wiki</a>
for details.</p>
</div>
<h2>Bugs</h2>
<div class="sectionbody">
<p>Please report feedback, <a href="http://grml.org/bugs/">bugreports</a> and wishes
<a href="http://grml.org/contact/">to the grml-team</a>!</p>
</div>
<h2>Authors</h2>
<div class="sectionbody">
<p>Michael Prokop &lt;mika@grml.org&gt;</p>
</div>
<div id="footer">
<div id="footer-text">
Last updated 29-Sep-2008 04:31:50 CEST
</div>
</div>
</body>
</html>

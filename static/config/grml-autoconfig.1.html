<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.10" />
<title>grml-autoconfig(1)</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>grml-autoconfig(1)</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name">Name</h2>
<div class="sectionbody">
<div class="paragraph"><p>grml-autoconfig - main bootup process of a grml system</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis">Synopsis</h2>
<div class="sectionbody">
<div class="paragraph"><p>None - it is a framework. See grml-autoconfig(8) for information regarding
the interface script.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>By using the config framework, it is possible to customize Grml&#8217;s startup in a
multitude of ways. It allows to:</p></div>
<div class="ulist"><ul>
<li>
<p>
execute one or more scripts on startup
</p>
</li>
<li>
<p>
install Debian packages from deb files on startup
</p>
</li>
<li>
<p>
unpack configuration on startup
</p>
</li>
</ul></div>
<div class="paragraph"><p>The combination of Debs, Configuration and Scripts is called DCS in Grml. DCS
can be read from the Live Image itself, from an arbitrary file system on the
local system which is marked with the volume label GRMLCFG, or from the file
system pointed to by the myconfig boot parameter.</p></div>
<div class="paragraph"><p>The DCS handling is controlled by a number of boot parameters.</p></div>
<div class="paragraph"><p>The scripts save-config and restore-config can be used to create and handle
files called <em>grml configuration archive</em>, abbreviated GCA. save-config stores
the running configuration inside a GCA; restore-config is a script to restore a
configuration from a GCA.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">A GCA is a plain bzip2 compressed tar archive. All the files are generated
starting from the root-directory <em>/</em> so it is easy to handle. You can generate
configuration archives manually as well. save-config is just a frontend which
should make it easier to use.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">Starting with Grml release 2009.05 its possible to use root persistency on grml.
This means you can store your settings and reuse them on reboot, without having
to deal with this config framework. Visit
<a href="https://github.com/grml/grml/wiki/persistency">https://github.com/grml/grml/wiki/persistency</a> for further information.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="current-versions">Behavior in current Grml versions</h2>
<div class="sectionbody">
<div class="paragraph"><p>This section applies to all Grml versions newer than release 2013.02.</p></div>
<div class="paragraph"><p>The central concept of grml-autoconfig is the DCS directory which holds debs,
configuration and scripts which are used during system startup.</p></div>
<div class="sect2">
<h3 id="_determination_of_dcs_directory">Determination of DCS directory</h3>
<div class="paragraph"><p>The DCS directory defaults to the root directory of the GRML live image
(Note: the directory is known as /run/live/medium/ on a <em>running</em>
Grml system then!). If a file system labeled GRMLCFG is found, the DCS
directory is the root directory of that file system. Alternatively, the
myconfig boot parameter can be used to directly specify a device which
is then taken as DCS directory (myconfig=/dev/sda1, for example). If
your device is labeled different to GRMLCFG the proper label can be set
via the autoconfig boot parameter (autoconfig=SOMELABEL, for example).</p></div>
<div class="paragraph"><p>Without any additional boot parameters, the GCA at DCSDIR/config.tbz is
automatically unpacked and DCSDIR/scripts/grml.sh is automatically executed on
system startup. The <em>noautoconfig</em> boot parameter disables this automatic
behavior.</p></div>
</div>
<div class="sect2">
<h3 id="_boot_parameters">Boot Parameters</h3>
<div class="paragraph"><p>The following boot parameters are supported. Use them at the (isolinux)
bootprompt as documented here.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
myconfig
</dt>
<dd>
<p>
   This parameter directly sets DCSDIR to the root directory of the specified
   device. Usage examples:
</p>
<div class="literalblock">
<div class="content">
<pre><code>myconfig=/dev/sda1                        =&gt; read DCS from usb-device</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
autoconfig
</dt>
<dd>
<p>
   This parameter specifies the label used to determine the DCS device.
   If undefined the label GRMLCFG is used to find the DCS device.
</p>
<div class="literalblock">
<div class="content">
<pre><code>autoconfig=SOMELABEL      =&gt; search for device labeled SOMELABEL to use as
                             DCS device.</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
home
</dt>
<dd>
<p>
    This parameter is for setting a specific partition as home directory.  Usage
    examples:
</p>
<div class="literalblock">
<div class="content">
<pre><code>home=/dev/sda3    =&gt;  use /dev/sda3 as the homepartition
home=scan         =&gt;  scan through the available partitions and search
                      for file grml.img</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
partconf
</dt>
<dd>
<p>
    This parameter mounts the specified device in read-only mode and tries to
    copy all files specified in /etc/grml/partconf to the Grml system. This
    provides the possibility to use the configuration of a harddisk
    installation. For example using the network configuration (which is
    specified in /etc/network) is possible using this boot parameter. Usage
    example:
</p>
<div class="literalblock">
<div class="content">
<pre><code>partconf=/dev/sda2 =&gt; try to mount /dev/sda2 and copy files specified
                      in /etc/grml/partconf to the booted Grml system</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
netconfig
</dt>
<dd>
<p>
    Use this parameter to restore configuration using wget to download a GCA
    from the specified destination. You can also add variables to change the
    file name depending on the host configuration. Predefined and useful
    variables are $ARCH, $HOSTNAME and $KERNEL. Usage example:
</p>
<div class="literalblock">
<div class="content">
<pre><code>netconfig=server.tld/path/to/config.tbz  =&gt;   restore configuration using wget to download file config.tbz
netconfig=server.tld/config-$ARCH.tbz    =&gt;   download config for specified architecture</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
netscript
</dt>
<dd>
<p>
    Use this parameter to download and run a script from specified destination:
    You can also add variables to change the file name depending on the host
    configuration. Predefined and useful variables are $ARCH, $HOSTNAME and
    $KERNEL. The environment variable NETSCRIPT is set to the specified URI.
    This can be used to detect if the script is executed via the netscript bootoption.
    Usage example:
</p>
<div class="literalblock">
<div class="content">
<pre><code>netscript=server.tld/path/to/script      =&gt;   download and run script/executable from server
netscript=server.tld/script-$HOSTNAME    =&gt;   download and run script/executable for specific host</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
extract
</dt>
<dd>
<p>
    Extract specific directories from the GCA which needs to be specified by
    other means.
</p>
<div class="literalblock">
<div class="content">
<pre><code>extract=/home/grml         =&gt; extract only /home/grml from archive
extract=/etc               =&gt; extract only /etc from archive
extract=/home/grml/config  =&gt; extract only $HOME/config from archive</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
scripts
</dt>
<dd>
<p>
    This parameter executes scripts. If an optional path is given, it is
    relative to DCSDIR. If the path points to a file, this single file is
    executed. If no path is given, it defaults to scripts/grml.sh.
    If the given name points to a directory, all scripts inside it are
    executed. Usage examples:
</p>
<div class="literalblock">
<div class="content">
<pre><code>scripts               =&gt;   run script DCSDIR/scripts/grml.sh
scripts=foobar.sh     =&gt;   run script foobar.sh in DCSDIR
scripts=foobar        =&gt;   run all scripts inside DCSDIR/foobar directory</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
config
</dt>
<dd>
<p>
    This parameter restores a configuration using a GCA. If an optional path is
    given, it is relative to DCSDIR. If no path is given, it defaults to
    DCSDIR/config.tbz. Usage examples:
</p>
<div class="literalblock">
<div class="content">
<pre><code>config                    =&gt;   restore configuration using file DCSDIR/config.tbz
config=config_foobar.tbz  =&gt;   restore configuration using file DCSDIR/config_foobar.tbz</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
debs
</dt>
<dd>
<p>
    This parameter allows automatic installation of deb packages while booting.
    The path is relative to DCSDIR, not optional and is a shell wildcard. All
    Files matching the wildcard are installed in a single dpkg --install call.
    For backwards compatibility, if no slash is contained in the path, it is
    taken relative to DCSDIR/debs.
</p>
<div class="literalblock">
<div class="content">
<pre><code>Usage examples:</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>debs=*.deb        =&gt;   install all debian packages (suffix .deb) from directory DCSDIR/debs/
debs=foo/01*.deb  =&gt;   install all debian packages (suffix .deb) starting with 01 in the filename from directory DCSDIR/foo</code></pre>
</div></div>
</dd>
<dt class="hdlist1">
debnet
</dt>
<dd>
<p>
    Search all local partitions and dm devices for file /etc/network/interfaces and
    copy the directory /etc/network to the grml system and restart networking.
</p>
</dd>
<dt class="hdlist1">
noautoconfig
</dt>
<dd>
<p>
    Deactivate automounting. By default the scripts try to mount a device with
    label <em>GRMLCFG</em>. If you specify the noautoconfig boot parameter this
    automounting will be deactivated.
</p>
<div class="literalblock">
<div class="content">
<pre><code>noautoconfig            =&gt; disables auto mounting of label 'GRMLCFG'</code></pre>
</div></div>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_permanently_adjust_boot_parameters">Permanently adjust boot parameters</h3>
<div class="paragraph"><p>As you probably know you can adjust boot parameters on the bootprompt.
You want to set some boot parameters permanently? That&#8217;s possible via
adding a directory named <em>bootparams</em> to the Grml ISO which has to be
located at the root-directory /bootparams/ (Note: the directory is known
as /run/live/medium/bootparams/ on a_running_Grml system then!).
Place a textfile inside the directory containing the boot parameters
which should be appended to default ones (this corresponds to booting
without any special parameters).</p></div>
<div class="literalblock">
<div class="content">
<pre><code>mkdir bootparams
echo lang=de &gt; bootparams/my_bootparams</code></pre>
</div></div>
<div class="paragraph"><p>Then burn a multisession CD where directory bootparams is located in the root
directory of the CD.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Not all boot parameters can be used via /bootparams/. This is a limitation of
the way the kernel and userspace retrieve boot parameters. Boot parameter
regarding the kernel definitely do <strong>NOT</strong> work. Boot parameter related to
grml-autoconfig (the main part of the boot process in Grml running in userspace,
being all the stuff after startup of udev) are expected to work. Boot parameter
related to initrd/initramfs (the part between <em>Searching for GRML file</em> and
startup of udev) are <strong>NOT</strong> covered by /bootparams/ as well yet.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">the application k3b (not available on the live-CD but available through the
Debian repositories) provides an easy to use interface for doing the
multisession task.</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="X7">Usage scenarios</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_personal_configuration_files">Personal configuration files</h3>
<div class="paragraph"><p>You are a fan of the editor vim? Great. You probably have your own <sub>/.vimrc and
want to use it on the Grml system. You also don&#8217;t like the default zsh
configuration and want to use your own </sub>/.zshrc?  How to proceed? Copy your
.vimrc and .zshrc to $HOME of user <em>grml</em>.  Place additional files in
$HOME/config. Now create a configuration for your files running:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>save-config -home -configdir</code></pre>
</div></div>
<div class="paragraph"><p>Now you should have a file named config.tbz containing your configuration files.
You can copy the archive to a webserver and restore it via downloading during
reboot using the following commandline on bootprompt:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>grml netconfig=server.tld/path/to/config.tbz</code></pre>
</div></div>
<div class="paragraph"><p>You don&#8217;t have network access but own a USB device? Copy the file to a USB
device and boot with something like:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>grml myconfig=/dev/sda1</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_network_configuration">Network configuration</h3>
<div class="paragraph"><p>You need a specific network setup and want to use your own
/etc/network/interfaces by default? Generate the configuration archive running
the following command as user root:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>save-config -etc</code></pre>
</div></div>
<div class="paragraph"><p>Now you should have a file named config.tbz containing your configuration files.
If you want to use it with a USB device copy the file to it and boot via
using the following command on boot prompt:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>grml myconfig=/dev/sda1</code></pre>
</div></div>
<div class="paragraph"><p>You do have an existing harddisk installation and want to use its configuration?
Let&#8217;s say the Debian system is located in /dev/sda2. You want to use the
directory /etc/network. This directory is activated by default in
/etc/grml/partconf so we don&#8217;t have to do any further work.  We just need to
activate it via using the following commandline on bootprompt:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>grml partconf=/dev/sda2</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_automatic_installation_of_debian_packages">Automatic installation of debian packages</h3>
<div class="paragraph"><p>You have a specified debian package named <em>foobar.deb</em> and want to use it with
(therefore: install it on) Grml by default? Notice: this feature is useful
especially for grml-small (a ~100 MB ISO). If you want to use it with the large
version of Grml you might have to overburn the ISO.</p></div>
<div class="paragraph"><p>Let&#8217;s assume you have burned the Grml iso to a CD-RW using a commandline like:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>cdrecord dev=/dev/hdc -v -multi -tao grml_0.5.iso</code></pre>
</div></div>
<div class="paragraph"><p>Now create a directory named debs and place foobar.deb in it:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>mkdir debs/ &amp;&amp; cp foobar.deb debs/</code></pre>
</div></div>
<div class="paragraph"><p>Notice: This directory will be located in /run/live/medium after burning the second
session.</p></div>
<div class="paragraph"><p>Now create the second session containing this directory:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>mkisofs -M grml_0.5.iso -C `cdrecord -msinfo dev=/dev/hdc` -R -o 2nd_session.iso debs</code></pre>
</div></div>
<div class="paragraph"><p>Finally append the second session to the cd using:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>cdrecord dev=/dev/hdc -v -multi -tao 2nd_session.iso</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">the application k3b (not available on the live CD but available through the
Debian repositories) provides an easy to use interface for doing the
multisession task.</td>
</tr></table>
</div>
<div class="paragraph"><p>Now boot from your new personalized Grml CD using the debs parameter:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>grml debs</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_run_your_own_commands_on_startup">Run your own commands on startup</h3>
<div class="paragraph"><p>You know that booting with <em>grml services=foobar</em> executes
/etc/init.d/foobar when booting Grml. But you want to setup a more
complex network configuration, adjust some other stuff and so on, on
your own? Just write a script named grml.sh which does the job and use
one of the mentioned boot parameters. Let&#8217;s say you have placed grml.sh
on your usb device (usb stick) then use the following commandline on
bootprompt:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>grml myconfig=/dev/sda1</code></pre>
</div></div>
<div class="paragraph"><p>Or even better: create a device with label GRMLCFG running (adjust /dev/sdX1
according to your needs):</p></div>
<div class="literalblock">
<div class="content">
<pre><code>mkfs.ext3 -L GRMLCFG /dev/sdX1  # warning: this destroys all data on /dev/sdX1</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">several filesystems provide the possibility to provide a label.  For
example FAT provides this through: <em>mkfs.vfat -n GRMLCFG /dev/sda1</em> (attention:
this will destroy data on /dev/sda1 of course!). Take a look at the
documentation/manpage of the filesystem you want to use.</td>
</tr></table>
</div>
<div class="paragraph"><p>Now place your configuration archive (see save-config and the other
usage scenarios) and the script grml.sh on the device. Now you can boot
your system without specifying any boot parameters on bootprompt because
devices labeled with GRMLCFG are mounted readonly and used by default.
If you did not label your device you can use the device anyway using
<em>grml myconfig=/dev/sdX</em> (adjust /dev/sdX) on the bootprompt.</p></div>
</div>
<div class="sect2">
<h3 id="_debug_remote_systems">Debug remote systems</h3>
<div class="paragraph"><p>You are responsible for a customer&#8217;s system in her data center. The system has
failed and you need to debug from remote, and the remote hands available in the
data center do not have enough knowledge to get Grml booted and configure the
network without external help?</p></div>
<div class="paragraph"><p>If the hard disk of the system is still available, you hopefully have saved a
configuration file with IP address, netmask and default gateway somewhere on
that hard disk. Grml can use the information found on a partition. Take a look
at the <em>partconf</em> boot parameter.  Usage example: <em>grml partconf=/dev/sda2</em>
copies files defined in /etc/grml/partconf from /dev/sda2 to the Grml system. As
/etc/network is predefined in /etc/grml/partconf the configuration from
/dev/sda2 will be taken.</p></div>
<div class="paragraph"><p>Or you use a standard Grml medium and have grml read IP address, netmask and
default gateway from another medium like a USB stick. Take a look at the script
saveconfig and the boot parameter myconfig.</p></div>
<div class="paragraph"><p>Or you put a grml.iso file on your hard disk (maybe in /boot/grml) or on an USB
stick, use grub to boot from there and place debs, configuration scripts or Grml
configuration archives alongside the .iso.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bugs">Bugs</h2>
<div class="sectionbody">
<div class="paragraph"><p>If you find a bug please report it. See <a href="http://grml.org/bugs/">http://grml.org/bugs/</a> for details
about how to report bugs.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">See also</h2>
<div class="sectionbody">
<div class="paragraph"><p>grml-autoconfig(8), restore-config(1), save-config(1)</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_author">Author</h2>
<div class="sectionbody">
<div class="paragraph"><p>(c) 2005++, Michael Prokop &lt;<a href="mailto:mika@grml.org">mika@grml.org</a>&gt;</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2019-03-21 13:50:31 UTC
</div>
</div>
</body>
</html>

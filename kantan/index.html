<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.4" />
<title>kantan(8)</title>
<style type="text/css">
/* Sans-serif font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
div#toctitle,
span#author, span#revnumber, span#revdate, span#revremark,
div#footer {
  font-family: Arial,Helvetica,sans-serif;
}

/* Serif font. */
div.sectionbody {
  font-family: Georgia,"Times New Roman",Times,serif;
}

/* Monospace font. */
tt {
  font-size: inherit;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  font-size: inherit;
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revnumber, span#revdate, span#revremark {
}

div#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #777777;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  div#footer-badges { display: none; }
}

div#toc {
  margin-bottom: 2.5em;
}

div#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }
</style>
<script type="text/javascript">
/*<![CDATA[*/
window.onload = function(){asciidoc.footnotes(); asciidoc.toc(2);}
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  var cont = document.getElementById("content");
  var noteholder = document.getElementById("footnotes");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      // Use [\s\S] in place of . so multi-line matches work.
      // Because JavaScript has no s (dotall) regex flag.
      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      spans[i].innerHTML =
        "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
        "' title='View footnote' class='footnote'>" + n + "</a>]";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
}

}
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>kantan(8)</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name">1. Name</h2>
<div class="sectionbody">
<div class="paragraph"><p>kantan - simple test suite for autotesting software using Grml and KVM</p></div>
</div>
</div>
<div class="sect1">
<h2 id="synopsis">2. Synopsis</h2>
<div class="sectionbody">
<div class="paragraph"><p>For the server (main) instance:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>kantan server &lt;disk.img&gt; &lt;grml.iso&gt; &lt;/mnt/point/of/iso/&gt; [kvm_arguments]</tt></pre>
</div></div>
<div class="paragraph"><p>or for client(s):</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>kantan client &lt;disk.img&gt; &lt;name&gt; [kvm_arguments]</tt></pre>
</div></div>
<div class="paragraph"><p>For further details please see section <a href="#options">[options]</a> and <a href="#setup">[setup]</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="options">3. Options</h2>
<div class="sectionbody">
<div class="paragraph"><p>Options for <em>kantan server</em>:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>&lt;disk.img&gt; &lt;grml.iso&gt; &lt;/mnt/point/of/iso/&gt; [kvm_arguments]</tt></pre>
</div></div>
<div class="paragraph"><p>where <em>disk.img</em> is an existing image file (created e.g. via <em>qemu-img create
disk.img 3G</em>), grml.iso is an a Grml ISO (<a href="http://grml.org/">http://grml.org/</a>),
/mnt/point/of/iso/ refers to the mount point where the specified Grml ISO is
mounted to (e.g. <em>mount -o loop grml-medium_sid_latest.iso /mnt/test</em>) and
<em>kvm_arguments</em> are optional and can be used to add additional arguments to the
KVM commandline, like <em>vga=791</em>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">The &lt;/mnt/point/of/iso/&gt; doesn&#8217;t necessarily need to be a real mountpoint.
It&#8217;s fine if you just copy linux26 and initrd.gz from /boot/* of the Grml
ISO to &lt;/path/to/foobar/boot/&gt; and specify &lt;/path/to/foobar/&gt; as mountpoint
directory then.</td>
</tr></table>
</div>
<div class="paragraph"><p>Options for <em>kantan client</em>:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>&lt;disk.img&gt; &lt;name&gt; [kvm_arguments]</tt></pre>
</div></div>
<div class="paragraph"><p>where <em>disk.img</em> is an existing image file (created e.g. via <em>qemu-img create
disk.img 3G</em>), <em>name</em> assigns the virtual instance a name (for reading
/etc/kantan/name.cfg iff the file exists). The <em>kvm_arguments</em> are optional and
can be used to add additional arguments to the KVM commandline, like <em>-boot d</em>
for booting from the ISO.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="description">4. Description</h2>
<div class="sectionbody">
<div class="paragraph"><p><span class="image">
<a class="image" href="kantan-screenshot.png">
<img src="kantan-screenshot.jpg" alt="kantan-screenshot.jpg" />
</a>
</span></p></div>
<div class="paragraph"><p>Kantan is a set of scripts to automatically test software using KVM
(<a href="http://www.linux-kvm.org/">http://www.linux-kvm.org/</a>) and the Debian based Linux live system Grml
(<a href="http://grml.org/">http://grml.org/</a>). You don&#8217;t have to set up neither tons of software packages
nor a complex environment but just follow some simple <a href="#setup">setup instructions</a>.</p></div>
<div class="paragraph"><p>It was originally developed to provide a simple way for autotesting specific
versions of FAI (<a href="http://fai-project.org/">http://fai-project.org/</a>) but is expected to provide a
simple-to-use test suite for autotesting any Linux based software.</p></div>
<div class="paragraph"><p>The concept of Kantan is to boot one virtual machine (the main instance, <em>kantan
server &#8230;</em>) which is supposed to be able to serve as installation server for
further virtual machines if needed. This concept for example allows to
automatically set up a <a href="http://fai-project.org/">FAI</a> server which then
deploys further started virtual machines (the clients, <em>kantan client &#8230;</em>).</p></div>
<div class="paragraph"><p>Kantan is meant to be a prototype implementation to show how automated testing
could be realised. In the long run the author would like to get a suite to
automatically test:</p></div>
<div class="ulist"><ul>
<li>
<p>
complete Debian installations
</p>
</li>
<li>
<p>
testing Debian packages within current state of Debian suites
</p>
</li>
<li>
<p>
software configurations that are required to run on more than one host
(installation procedures with dependencies between different systems during
installation, cluster + HA setups,&#8230;)
</p>
</li>
<li>
<p>
live systems with their flexible boot options, specific features and services
</p>
</li>
<li>
<p>
kernel versions
</p>
</li>
<li>
<p>
software packages that provide unit tests
</p>
</li>
<li>
<p>
low-level tools like partitioning, LVM, mdadm,&#8230;
</p>
</li>
<li>
<p>
filesystems (crash, repair, mount,&#8230;)
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution" />
</td>
<td class="content">This software is WIP, though released in an early stage to gain feedback,
testers and developers. It&#8217;s a prototype implementation mainly in shellscript
but is expected to be rewritten in a real scripting language like python.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="requirements">5. Requirements</h2>
<div class="sectionbody">
<div class="paragraph"><p>What you need to be able to use Kantan:</p></div>
<div class="ulist"><ul>
<li>
<p>
a Debian (based) system (any other Linux system might do it as well, but
  the scripts and docs are optimised for Debian (based) systems for now)
</p>
</li>
<li>
<p>
a system running i386 or amd64 architecture (to smoothly use KVM)
</p>
</li>
<li>
<p>
at least 2GB of RAM are recommended
</p>
</li>
<li>
<p>
at least 4GB of harddisk space for &gt;=2 virtual disk images
</p>
</li>
<li>
<p>
a Grml ISO (see instructions below)
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="setup">6. Setup and Usage Instructions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Install the kantan Debian package, which for now is available from
<a href="http://people.debian.org/~mika/kantan/">http://people.debian.org/~mika/kantan/</a></p></div>
<div class="paragraph"><p>Grab a Grml ISO and mount it somewhere:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>% wget download.grml.org/grml64-medium_2010.04.iso
% wget download.grml.org/grml64-medium_2010.04.iso.md5
% md5sum -c grml64-medium_2010.04.iso.md5
% sudo mount -o loop grml64-medium_2010.04.iso /mnt/test</tt></pre>
</div></div>
<div class="paragraph"><p>If necessary adjust /etc/kantan/server.cfg according to your needs.</p></div>
<div class="paragraph"><p>Create image files for use as /srv within FAI server and as harddisk for the FAI
client (qemu-img is available from qemu-utils):</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>% qemu-img create fai-server.img 3G
% qemu-img create fai-client.img 3G</tt></pre>
</div></div>
<div class="paragraph"><p>If you want to provide any local Debian packages to the FAI server instance
(like for example a specific version of FAI you&#8217;d like to test) just create the
directory <em>debs</em> in the current working directory (being the one where you&#8217;ll
invoke kantan later on), like for example:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>% mkdir debs
% dget -u -d http://fai-project.org/download/squeeze/fai_3.4.4_amd64.changes
% mv fai*.deb debs/</tt></pre>
</div></div>
<div class="paragraph"><p>Finally execute the kantan script as $USER for the server instance, providing
the path to the generated image file, the Grml-ISO and the mountpoint where the
Grml ISO is mounted on:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>% kantan server fai-server.img grml64-medium_2010.04.iso /mnt/test</tt></pre>
</div></div>
<div class="paragraph"><p>Finally start the FAI client instance (the one that should be installed by the
kantan server VM), specifying <em>grml</em> as client name (so /etc/kantan/grml.cfg
would be read if it exists) and "-boot d" as boot option for KVM so it uses the
PXE ISO for booting (just drop "-boot d" then when installation of client has
finished):</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>% kantan client fai-client.img grml "-boot d"</tt></pre>
</div></div>
<div class="paragraph"><p>That&#8217;s it! :) Further usage scenarious and tests will follow.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="faq">7. FAQ</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="why_kantan">7.1. Why Kantan?</h3>
<div class="paragraph"><p>The author of Kantan thinks that lack of proper Q/A is one of the most annoying
issues in the open source world. So let&#8217;s do something against that.</p></div>
</div>
<div class="sect2">
<h3 id="what_does_kantan_mean">7.2. What does Kantan mean?</h3>
<div class="paragraph"><p>The author of Kantan is a friend of the
<a href="http://en.wikipedia.org/wiki/Kanban">Kanban</a> concept and created the word
Kantan based on "the Kanban of testing".  Amusingly according to
<a href="http://www.cjvlang.com/Writing/writjpn/signs/kantan.html">http://www.cjvlang.com/Writing/writjpn/signs/kantan.html</a> "Kantan is a
Chinese-style compound (on-reading) meaning <em>simple</em>." which represents the idea
of Kantan: provide a <em>simple</em> method for testing software.</p></div>
</div>
<div class="sect2">
<h3 id="kantan_vs_chroot">7.3. Why use a VM and not just a chroot?</h3>
<div class="paragraph"><p>Chroots provide a nice way for testing stuff like package installations. But
they are limited to some restricted actions. Chroots don&#8217;t properly support
testing kernel versions, bootoptions, partitioning tools, LVM, mdadm,&#8230; in a
reasonable environment.</p></div>
</div>
<div class="sect2">
<h3 id="external_system">7.4. How can I use Kantan with physical machines?</h3>
<div class="paragraph"><p>By default Kantan uses vde_switch for network configuration. This provides a
working network setup between the server and the client(s) machines without
having to configure anything. But if you want to use external, physical machines
this does not work any longer.  Instead just set up tap devices so you can
install clients on real[tm] hardware.</p></div>
<div class="paragraph"><p>Assume the following setup: the Kantan server is the server where you&#8217;re executing
"kantan server &#8230;". The test client is the machine where you want to boot
the system which would be corresponding to "kantan client &#8230;" (but instead of
executing "kantan client &#8230;" as virtual guest you&#8217;re running it on physical
machine). NIC eth0 is providing internet access (WAN). NIC eth1 is the network
link between the server and the client machine.</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>+----------------+
| Kantan   ,-----|----- eth0 ----- [ Internet/WAN ]
| Server   |     |
|        [tap1]  |
|          |     |
|          `-----|----- eth1 ----- [ Test client ]
+----------------+</tt></pre>
</div></div>
<div class="paragraph"><p>Then the following configuration should do the trick for you:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt># example config for /etc/network/interfaces
iface vnet inet static
      post-up tunctl -u grml -g grml -t tap1 ; brctl addif vnet tap1 ; ip link set up dev tap1
      post-up brctl addif vnet eth1
      pre-down ip link set down dev tap1 ; tunctl -d tap1
      bridge_ports none
      address 192.168.10.2
      netmask 255.255.255.0</tt></pre>
</div></div>
<div class="paragraph"><p>Configure /etc/kantan/server.cfg:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>VLAN1_DEVICE='tap1'</tt></pre>
</div></div>
<div class="paragraph"><p>Then execute:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>ifup vnet
echo 1 &gt; /proc/sys/net/ipv4/ip_forward
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</tt></pre>
</div></div>
<div class="paragraph"><p>To forward DNS requests from the clients to the physical net use dnsmasq:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>/etc/init.d/dnsmasq start || apt-get install dnsmasq</tt></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="todos">8. TODOs</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_known_todos">8.1. Known todos</h3>
<div class="ulist"><ul>
<li>
<p>
provide test features and tests from
  <a href="https://git.grml.org/?p=grml-unittests.git;a=summary">grml-unittests</a>
</p>
</li>
<li>
<p>
better logging and data sharing support to collect data and status report
  and control data flow between different virtual machines
</p>
</li>
<li>
<p>
make sure vnc and serial console display the same things during
  execution within Grml
</p>
</li>
<li>
<p>
netscript.sh:
</p>
<div class="ulist"><ul>
<li>
<p>
support svn/git/&#8230; config space retrieval
</p>
</li>
<li>
<p>
improve arch and suite support through base.tgz
</p>
</li>
<li>
<p>
support canceling the script and getting a debugshell
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_checkout">8.2. Checkout</h3>
<div class="ulist"><ul>
<li>
<p>
use kvm&#8217;s monitor support for sharing/controlling data?
</p>
</li>
<li>
<p>
investigate and combine/merge features/ideas/approaches from:
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="http://kvm.et.redhat.com/page/KVM-Autotest">http://kvm.et.redhat.com/page/KVM-Autotest</a>
</p>
</li>
<li>
<p>
<a href="http://lizards.opensuse.org/2010/05/25/automated-opensuse-testing/">http://lizards.opensuse.org/2010/05/25/automated-opensuse-testing/</a>
</p>
</li>
<li>
<p>
<a href="https://git.grml.org/?p=grml-unittests.git;a=summary">https://git.grml.org/?p=grml-unittests.git;a=summary</a>
</p>
</li>
<li>
<p>
<a href="http://www.mozilla.org/projects/testopia/">http://www.mozilla.org/projects/testopia/</a>
</p>
</li>
<li>
<p>
<a href="https://wiki.ubuntu.com/AutomatedTesting">https://wiki.ubuntu.com/AutomatedTesting</a>
</p>
</li>
<li>
<p>
<a href="https://wiki.ubuntu.com/AutomatedTestingDeployment">https://wiki.ubuntu.com/AutomatedTestingDeployment</a>
</p>
</li>
<li>
<p>
<a href="https://wiki.ubuntu.com/Testing/ISO/Procedures">https://wiki.ubuntu.com/Testing/ISO/Procedures</a>
</p>
</li>
<li>
<p>
<a href="https://wiki.edubuntu.org/VirtFeatureVerification">https://wiki.edubuntu.org/VirtFeatureVerification</a>
</p>
</li>
<li>
<p>
<a href="http://wiki.virtualsquare.org/wiki/index.php/VDE_Basic_Networking#Dump_or_Monitor_switch_traffic">http://wiki.virtualsquare.org/wiki/index.php/VDE_Basic_Networking#Dump_or_Monitor_switch_traffic</a>
</p>
</li>
<li>
<p>
<a href="http://developer.amd.com/zones/opensource/AMDTapper/Pages/default.aspx">http://developer.amd.com/zones/opensource/AMDTapper/Pages/default.aspx</a>
</p>
</li>
</ul></div>
</li>
<li>
<p>
tools that might help in automated testing:
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="http://ldtp.freedesktop.org/wiki/">GNU LDTP</a>
</p>
</li>
<li>
<p>
<a href="http://seleniumhq.org/">Selenium</a>
</p>
</li>
<li>
<p>
<a href="http://shunit.sourceforge.net/">ShUnit</a>
</p>
</li>
<li>
<p>
<a href="http://groups.csail.mit.edu/uid/sikuli/">Sikuli</a>
</p>
</li>
<li>
<p>
<a href="http://synflood.at/programs.html">Tuitest</a>
</p>
</li>
<li>
<p>
<a href="http://hoopajoo.net/projects/xautomation.html">Xautomation</a>
</p>
</li>
<li>
<p>
<a href="http://pythonpaste.org/webtest/">WebTest</a>
</p>
</li>
<li>
<p>
<a href="http://en.wikipedia.org/wiki/List_of_GUI_testing_tools">http://en.wikipedia.org/wiki/List_of_GUI_testing_tools</a>
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bugs">9. Bugs</h2>
<div class="sectionbody">
<div class="paragraph"><p>Probably. We just need a test suite for Kantan for testing.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="author">10. Author</h2>
<div class="sectionbody">
<div class="paragraph"><p>Michael Prokop &lt;<a href="mailto:mika@grml.org">mika@grml.org</a>&gt;</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2011-04-18 15:29:52 CEST
</div>
</div>
</body>
</html>
